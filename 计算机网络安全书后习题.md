# 第一章 概论

## 1. 怎样理解安全的相对性

系统的安全程度总是相对于系统的安全需求的，而这种需求是可以随系统的任务和系统的环境所变化的。

同一种资源相对于不同的拥有者具有不同的价值，所以对其的安全需求往往不相同。

安全措施的运用是用成本的，并非越多越好，需要根据安全目标和系统风险来选择。

系统环境、安全目标和系统的威胁都可以随时间而改变，安全措施也应随之而变化。

对于网络安全而言，不同的安全目标会要求面对相同的网络威胁而采取不同的安全措施。

## 2. 试讨论在数据的保密性、完整性、真实性、所有权都得以保持的情况下，是否会出现数据不可用的情况？

只保证了不出现意外结果，但是没有保证遵循安全策略

会出现数据不可用的情况。如：

* 攻击者切断了服务器的电源，导致数据存储在服务器中，但服务器无法使用

## 3. 试给出一个对手思维的例子

由于知道防御者可能会将恶意软件在虚拟机中执行，以消除其危害并分析其行为，攻击者在恶意软件中会判断运行环境是否为虚拟机，如果是虚拟机则不运行。

设计登录过滤以防止SQL注入

## 4. 试给出一个系统思维的例子

对一个服务器进行保护的时候，不仅需要保护其操作系统、软件，还需要保护其硬件不受入侵。将整个计算机看作一个系统来进行保护。

## 5. 按照CSEC2017网络空间安全课程体系指南中的知识区划分，试讨论各知识区中哪些知识单元的内容和网络安全有关？

每个知识单元的内容都和网络安全有关。

# 第二章 网络攻击

## 1. 网络攻击分类的依据有哪些？

* 攻击行为的发起方式
* 攻击目的
* 攻击对象
* 攻击的进化

## 2. 什么是网络黑客行为，不同类别的网络黑客是否有共性？

试图使用非正常方式访问计算机系统或基于计算机的应用系统的人。

有共性：都是通过网络攻击来实现目的。采用非正常手段访问计算机系统或基于计算机的应用系统。对网络系统漏洞发现并利用

## 3. 安全漏洞和安全威胁的区别是什么？

安全漏洞是系统中的弱点。

网络空间中的一个资源可能会存在一个或多个安全漏洞，如果这些安全漏洞被攻击者在某个攻击活动中利用，就可能会对该资源的安全性产生威胁，从而产生安全威胁。

一个安全漏洞可被利用且有人要利用时，才产生安全威胁。

## 4. 安全漏洞是否一定要披露，什么样的安全漏洞不会被披露？

不一定要披露。安全漏洞有可能产生于系统的使用过程，而其往往因人而异，通常属于管理方面的问题，因此这种安全漏洞不属于披露的范围。

## 5. 安全漏洞会通过哪些途径消除？

* 对于设计过程中产生的漏洞，可以通过重新设计部分细节或者整个重新设计来消除
* 对于实现过程中产生的漏洞，可以通过增加补丁、消除Bug来消除
* 对于管理过程中产生的漏洞，可以通过增加规范来消除

## 6. 建立安全漏洞库的主要目的是什么？

为了管理和标准化漏洞信息，搜集在互联网空间中出现的各类漏洞，通过标准化的命令、编号和描述来让这些漏洞信息可以被自动化地利用。

## 7. CVE, CWE, CPE, NVD, Exploit-DB之间是什么关系？

CVE（公共漏洞与暴露库）、NVD（美国国家漏洞库）、Exploit-DB均是漏洞库

NVD通过对CVE条目分析，将漏洞的公共信息资源关联起来

Exploit-DB与CVE兼容

CWE（公共漏洞枚举库）、CPE（公共平台枚举库）是CVE的配套的信息库。CWE的目的是提供对安全漏洞的标准分类，以便对这些安全漏洞进行分类管理和查询。CPE的目的是为产生安全漏洞的那些信息系统、设备和开发工具等进行标准分类，以便更为准确地描述安全漏洞的相关信息。

## 11. 入侵攻击传统模型和网络杀伤链模型的区别有哪些？

* 一次攻击可能重复多次网络杀伤链，而只有一次入侵攻击传统模型
* 传统模型强调了隐藏攻击源的步骤，而网络杀伤链中则没有强调
* 传统模型中的攻击目标的漏洞挖掘，在网络杀伤链中细化为侦查、武器化

## 12. ATT&CK模型为什么要区分攻击的战术和技术？

战术是攻击者的近期目标，技术是攻击者达成战术目标所使用的手段。

为了确立ATT&CK矩阵，方便建立矩阵，展现关联性

## 13. 如何应用ATT&CK知识库进行防御间隙的SOC成熟度评估？

针对ATT&CK知识库中的每一个战术，依次采用其对应的技术对组织自己进行攻击，来查看SOC的反应。如果SOC成功组织，说明此技术不在防御间隙中，同时也说明SOC在此处成熟度较高。

## 14. 网络入侵攻击中进入的目的是什么？

获取系统用户权限，在被攻击系统中获得一个攻击的落脚点，通过提权方法获得更高的权限。

## 15. 进入攻击方法的设计怎样体现了对手思维？

以对手的行为习惯考虑被攻击所在系统和网络漏洞和可能采取的防御措施

## 16. 供应链攻击和水坑攻击分别适用于什么样的用户类型？

供应链攻击：被攻击对象为开发者，受害者为使用开发者软件的人群。

水坑攻击：被攻击对象为第三方平台，受害者为使用第三方平台的人群。

## 17. 各种提权攻击方法中哪些利用的是设计漏洞，哪些利用的是实现漏洞，哪些利用的是管理漏洞？

特权程序漏洞利用为实现漏洞，路径/配置劫持为设计漏洞，配置不当漏洞为管理漏洞

## 18. 木马可以服务于ATT&CK模型中的哪些战术，对应这些战术分别需要具备什么功能？

* 初期进入。需要具备可植入性
* 执行。需要具备可执行性
* 防御逃避。需要具备隐蔽性
* 收集。需要具备远程沟通功能
* 指挥与控制。需要具备远程操控性
* 影响。需要具备破坏性

## 19. 服务失效攻击的对象是什么，这些对象具有什么特点？

大多数对象均为服务提供者，包括网络基础设施、关键信道、特定服务。特点是其被服务者的数量没有限制，而自身能力有限制。并且是网络交互中的关键节点，一旦失效，对应功能和服务也会失效，造成大量崩溃影响。

# 第三章 僵尸网络

## 1. 试讨论网络蠕虫与僵尸网络的行为共性与区别

共性：都是恶意入侵他人系统的恶意代码，均可以在主机间传播，并进行破坏工作（攻击、破坏、感染）

区别：

* 网络蠕虫：其传播不受控制，无法接收命令，爆发时间快，破坏性巨大
* 僵尸网络：传播可控，可以通过C2信道进行控制与命令，具有高交互性和高隐蔽性，攻击分散，通常具有一定的结构体系

## 2. 试概括Morris蠕虫的攻击流程

## 3. 僵尸程序从哪些方面考虑了自身隐蔽性的实现？

* 传播过程可控，不会产生大量的数据交互引起注意
* 采用中继节点，攻击者难以被定位
* 在感染受害主机后，僵尸程序会进入潜伏状态，在僵尸控制器命令到来时才会进入活跃状态
* 使用Fast-Flux技术或动态DNS技术

## 4. 试分析Domain Fluxing方法的工作效率

假设域名列表有$N$个，其中有$n$个域名被C2控制器注册，记$X$为僵尸程序找到正确控制器所进行的尝试次数，$Z_i$为一个标志变量，如果僵尸程序找到正确域名之前尝试了第$i$个假域名，则其为1，否则为0. 那么
$$
X-1=\sum_{i=1}^{N-n}Z_i
$$
因此
$$
EX=1+\sum_{i=1}^{N-n}EZ_i=1+\frac{N-n}{n+1}=\frac{N+1}{n+1}
$$
也就是说，平均而言，需要$\frac{N+1}{n+1}$次尝试才能找到正确域名。当$n$固定时，是$O(N)$的时间复杂度。因此，工作效率较高。

# 第四章 黑色产业

## 1. 为什么黑色产业链中会出现合法的参与者？

黑色产业链中的角色并无合法与非法之分，以其实际的行动和动机而定

* 需求提供者希望进行一个合法商品的广告宣传
* 服务提供者可以是合法的支付平台
* 基础设施提供者可以是合法的云服务平台
* 工具开发者的工具一般是中性的

## 2. 暗网要具备怎样的条件，如何构造一个暗网？

只能用特殊软件、特殊授权或对计算机做特殊设置才能访问，基于隐藏的网络，不能从公开的渠道获得访问地址。从用户界面的角度看，暗网是一种隐藏入口的网站，需要通过特殊的渠道获得其入口标识。从传输的角度看，暗网是一种隐藏网络拓扑结构的网络，采用匿名通信技术来躲避追踪和拦截。

可以采用P2P的分散控制结构，并使用非标准的协议和端口，且对外封闭来构造一个暗网。

## 3. 试讨论网络杀伤链与社会工程攻击基本流程框架的异同

相同：

* 都需要对攻击对象进行信息搜集，即侦查。
* 都需要基于搜集的信息对攻击进行准备，即武器化。搜集信息越多，成功率越高
* 在攻击准备好之后，就进行攻击接触，即投放。
* 在攻击的过程中，一开始是启动，使被攻击者进入情绪状态，也就是杀伤链中的漏洞利用；第二阶段是启发，也就是杀伤链中的控制与命令

不同：

* 网络杀伤链采用的是技术手法以及社会工程手法并用，而社会工程攻击基本流程只采用社会工程手法
* 网络杀伤链是一个重复的过程，有可能在漏洞利用之后需要建立新的网络杀伤链，而社会工程攻击基本流程是持续的，但不是重复的
* 网络杀伤链中投放需要多次，但攻击接触只需要一次
* 社会工程攻击一旦被发现后，成果可能会变得不可用，需要隐藏撤离

## 4. 黑色产业链中哪些角色会用到社会工程方法？

服务提供者在提供满足需求所需要的服务时，可以使用社会工程方法进行服务。

信息提供者获得信息的方法，可以是社会工程方法。

## 5. 试给出一个基于互惠心理的社会工程攻击的例子

攻击者以一种友善的方式和语义与被攻击者沟通

下载得红包

## 6. 试给出一个利用强烈情绪影响的社会工程攻击的例子

冒充执法或司法机构来威胁被攻击者

冒充警察实施诈骗

## 7. 网络钓鱼攻击的基本目的是什么？

窃取被攻击者的敏感信息，以作为对其实施进一步攻击的基础，也可以将窃取的信息用作牟利。

## 8. 试讨论面向下载的产业链与面向销售的产业链的共性与区别，因此它们各自的技术侧重点分别是什么？

共性：

* 都是互联网商业模式
* 都使用黑色产业链达到目的
* 目的都是获得利益
* 内容提供者向内容发布者提供需求，内容发布者来满足需求

区别：

* 面向下载的产业链的盈利方式是下载即可赚钱，面向销售的产业链的盈利方式是购买才可赚钱
* 面向下载的产业链多是线上模式，而面向销售的产业链则采用线上线下结合的模式
* 面向销售的产品多为非法产品

技术侧重点：

* 面向下载的产业链：如何诱导消费者点击下载，只需隐藏自身即可
* 面向销售的产业链：不仅需要隐藏自身，还需要让消费者在购买的时候不发现问题

## 9. 试讨论网络实名制对窃取与销赃产业链的影响

实名后的信息如果被不当利用，会有利于信息窃取，甚至导致资产窃取。

如果实名信息被妥善保管，那么只有本人才能进行资产操作，从而有力维护了资产不被窃取

## 10. 怎么理解勒索软件密钥管理模式中的用户域解密模式，试举例说明

用于解密被加密的用户数据的密钥处于用户可及的范围内，如在受害主机中，或者内嵌在勒索软件中。也就是说，用户可以直接找到解密密钥从而进行解密。

## 11. 社会工程方法如何应用到APT攻击中？

APT组织找到易受攻击的攻击对象，如被攻击机关人员的家属等，对其进行社会工程攻击，将恶意软件通过其传播入被攻击机关。

# 第五章 网络入侵检测

## 1. 入侵检测系统的分类可以有哪些依据？

* 实现形式
    * HIDS
    * NIDS
    * ...
* 被定义的事件集合范围
    * 滥用监测
    * 异常检测

## 2. 试比较异常检测技术和误用检测技术各有哪些优势和不足

* 滥用检测
    * 优势
        * 误报率低，并且对每种入侵都能提供详细的资料，使得使用者能够很方便地作出响应
        * 技术相对成熟，实现效率高
    * 不足
        * 不能检测出新的入侵行为，因为特征库中还没有其特征描述
        * 完全依赖于入侵特征的有效性，因此必须不断地及时更新特征库
* 异常检测
    * 优势
        * 能够检测出新的网络入侵方法的攻击
        * 较少依赖于特定的主机操作系统
    * 不足
        * 行为基准模型建立困难，因为网络的流量行为不一定呈现明显的规律性和稳定性
        * 因为正常行为和异常行为之间未必存在明显差异，因此检测的误报率往往较高

## 3. 试讨论影响滥用入侵检测系统检测精度的因素有哪些

* 新的网络入侵方法没有被录入特征库，从而会导致FN上升，使精度下降

## 4. 入侵检测系统的数据采集功能涉及哪些工作，需要考虑哪些问题？

涉及原始网络报文的采集和预处理，挑选出对入侵检测有意义的报文供入侵检测模块使用。如果入侵检测模块是并行运行的，则采集层还要负责负载均衡和报文分配工作。

需要考虑选择哪些报文是对入侵检测有意义的，如ICMP报文等一般不用作入侵，不需要考虑。软件报文采集，2-copy与0-copy

## 5. 滥用入侵检测系统包含哪些主要功能，它们分别涉及什么算法？

* 报文采集
    * 2-copy
    * 0-copy
* 报文分类
* 入侵检测
    * 面向报文头HiCuts
    * 对报文数据BM算法
* 响应管理
    * HMM方法与贝叶斯网络模型
* 冗余消除

## 6. 滥用入侵检测系统使用的检测规则是无序的吗，为什么？

不是。因为更普遍的检测规则应在更前面，这样可以减少检测规则的匹配次数

## 7. 简述基于系统调用序列的HIDS的工作原理，并讨论影响检测精度的相关因素

系统调用是内核向用户服务的唯一途径，进程在执行的过程中产生系统调用序列。正常情况下，进程执行的系统调用呈现出较稳定的特性；而异常情况下，进程执行的调用序列会偏离这种特性，因此通过对这种特征片段的学习、统计和分析可以识别出入侵行为。

* 特征库的特征量
* 检测算法

## 8. 试设计一个防范网页被篡改的HIDS，请给出检测算法和系统的总体结构



## 12. 简述蜜罐的概念及分类情况

蜜罐从形式上看通常是一个真实的计算机系统，存在的目的就是吸引攻击者，供研究者用来探查攻击的给出和所使用的方法。

分类情况：

* 应用目的
    * 产品型
    * 研究型
* 交互度
    * 低交互度
    * 中交互度
    * 高交互度
* 实现形式
    * 物理蜜罐
    * 虚拟蜜罐

## 13. 什么是蜜罐系统的服务模拟，具体形式是怎样的？

对攻击者提供一定的服务，用相应的软件和专门的蜜罐来实现。具体形式如模拟的web服务器等

## 14. 蜜网架构的核心需求有哪些？

* 由蜜墙、防火墙、IDS和多个蜜罐主机构成，达到数据控制、数据分析、数据捕获的目的
* 获取广泛的安全威胁信息
* 更准确地了解黑客的攻击趋势和特征以及使用的各种工具和技术

# 第六章 网络安全防御

## 6. 系统脆弱性评估的基本思路是什么？

依靠各种管理和技术手段对系统进行检测，找出可能存在的安全隐患。根据检测结果分析、评估系统的安全状况。在此基础上，根据评估结果，制定恰当的安全策略，为系统安全的设计提供参考依据。

## 8. 为什么要对系统实行分级保护？

通过分级制度使系统更加安全，人们通过对应的用户、用途、安全需求可以指定相应的保护政策，合理规避风险。国家要求。

## 10. 试给出一个日常生活中侧通道存在的例子

打电话被窃听

## 12. 试讨论Nmap与Zmap的优缺点，并举例说明他们分别适用于什么工作场景

### Nmap

* 优点
    * 使用脚本来描述具体的扫描处理功能，并建有丰富的脚本库
* 缺点
    * 扫描性能较低，不能对全球互联网即时扫描

适用于小范围的，对扫描功能要求较高的工作场景

### Zmap

* 优点
    * 具有独特的扫描交互机制，可以获得很高的扫描性能，可以对全球互联网即时扫描
* 缺点
    * 没有脚本扫描功能，扫描能力较弱

适用于大范围的，乃至全互联网的，对扫描功能要求较少的工作场景

## 14. 试讨论风险评估和损失评估的共性与区别，他们分别适用于应急响应处理的哪个阶段？

* 共性
    * 对状况进行响应造成的影响的评估
* 区别
    * 进行的阶段不同，风险存在可能性，损失为已确定的情况

风险评估位于检测阶段，损失评估位于总结阶段

## 15. 如何理解协同的概念？协同入侵检测与单点的入侵检测相比，有什么优势和问题？

每个IDS在使用时都有特定的覆盖范围，而网络入侵往往会影响多个系统。因此，为了综合IDS的监测结果或在IDS之间共享监测信息，扩大IDS的监测能力，需要实现协同防御。

* 优势
    * 可扩展性好，对同构性要求较低
    * 管理器不会构成检测系统的性能和故障瓶颈
* 问题
    * 需要部署的IDS较多，规模较大，消耗较多
    * 规范格式存在难度
    * 不同设备间存在差异，协同化难度高

# 第七章 网络攻击阻断

## 3. 如何在状态监测防火墙中增加适当表项以防御TCP SYN Flooding攻击

当TCP连接对应的流量超过阈值时，所有报文给予拦截

## 4. 防火墙使用中的有孔方法和无孔方法的区别是什么，选用这两种方法的最基本考虑是什么？

有孔方法中，外部网可以请求内部网的部分服务，而无孔方法中，外部网的所有请求都被堡垒主机处理，不会进入内部网。

最基本考虑为内部网对外部网提供的服务的种类、数量。安全需求和对应成本

## 9. 实施TCP会话拦截的节点是否一定要位于被拦截会话的通信路径上，为什么？

大部分情况下要。因为报文传输路径的不同会导致报文到达端点时的TTL值和真实的TTL值不相符，有一些软件会根据TTL过滤异常的RST报文来逃逸拦截。

# 第九章 网络基础设施保护

## 1. 试比较RADIUS方法与IEEE 802.1X方法的区别

* RADIUS中的客户端在IEEE 802.1X中分为两个：客户端和设备端
* RADIUS中用户不需要安装软件
* IEEE 802.1X方法中，认证服务器收到用户名后，会随机生成质询值防止重放攻击
* IEEE 802.1X方法中，用户上线后依然会定期和设备端发送握手报文，维护在线状态，同时也会有防止意外下线的手段

## 2. 假设攻击者可以自动生成MAC地址，并通过大量生成不同的MAC地址去向DHCP服务器申请IP地址，这成为DHCP服务器饥饿攻击。如何防范这种攻击？

端口安全

## 3. 临时和偶尔进入网络的用户称为访客，对访客实施怎样的接入认证方法比较合理？

RADIUS, 因为不需要安装认证软件，不常用。

## 4. 试讨论窥探方法的优缺点

* 优点
    * 可以增强安全性
* 缺点
    * 需要额外的空间存储表项，额外的时间分析报文

## 5. 试讨论IP源保护方法的优缺点

* 优点
    * 可以增强安全性，防止非法用户IP接入网络
* 缺点
    * 需要额外的空间存储表项，额外的时间分析报文

## 6. 路由源鉴证信息与路由源授权信息在路由信息有效性判定中各起什么作用？

* 路由源鉴证信息：证明资源持有的合法性
* 路由源授权信息：表明IP地址前缀的拥有者授权某个AS发布这个地址前缀的路由信息

## 7. 潜通道和侧通道有什么区别？

* 潜通道：隐藏在正常通信协议下的通道
* 侧通道：用非正常手段获取额外的信息

## 11. 如何使用IPsec对DNS解析流量进行保护？

## 12. IPsec功能适合部署在网络的什么位置？

主机或网关或独立加密机

## 13. 对于传递公钥的功能而言，请讨论DNSSEC与PKI的区别

* PKI通过公钥证书来发送，只通过一层加密
* DNSSEC通过增加公钥的资源记录来实现，一层一层进行加密